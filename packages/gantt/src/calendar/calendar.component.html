<svg [attr.width]="view.width" [attr.height]="height">
  <g class="mesh">
    <g>
      <rect
        *ngFor="let group of groups; groupTrackBy"
        [attr.width]="view.width"
        [attr.height]="group.refs.height"
        [attr.x]="group.refs.x"
        [attr.y]="group.refs.y"
        class="mesh-item"
      ></rect>
      <rect
        *ngIf="groups?.length > 0"
        [attr.width]="view.width"
        [attr.height]="'100%'"
        [attr.x]="0"
        [attr.y]="groups[groups.length - 1].refs.y + groups[groups.length - 1].refs.height"
        class="mesh-item"
      ></rect>
    </g>
    <g>
      <line
        *ngFor="let group of groups"
        [attr.x1]="0"
        [attr.x2]="view.width"
        [attr.y1]="group.refs.line.y1"
        [attr.y2]="group.refs.line.y2"
        class="mesh-line"
      ></line>
    </g>
  </g>
  <g class="date">
    <g *ngIf="view.showTimeline">
      <line
        *ngFor="let point of view.secondaryDatePoints; let i = index; trackBy: trackBy"
        [attr.x1]="(i + 1) * view.cellWidth"
        [attr.x2]="(i + 1) * view.cellWidth"
        [attr.y1]="0"
        [attr.y2]="'100%'"
        class="secondary-line"
      ></line>
      <line
        *ngFor="let point of view.primaryDatePoints; let i = index; trackBy: trackBy"
        [attr.x1]="(i + 1) * view.primaryWidth"
        [attr.x2]="(i + 1) * view.primaryWidth"
        [attr.y1]="0"
        [attr.y2]="'100%'"
        class="primary-line"
      ></line>
    </g>
    <g *ngIf="view.showWeekBackdrop">
      <g *ngFor="let point of view.secondaryDatePoints; let i = index; trackBy: trackBy">
        <rect
          *ngIf="point.additions?.isWeekend"
          [attr.x]="i * view.cellWidth"
          [attr.y]="0"
          [attr.width]="view.cellWidth"
          [attr.height]="'100%'"
          class="secondary-backdrop"
        ></rect>
      </g>
    </g>
    <g>
      <polygon *ngIf="todayPoint" class="today-line-angle" [attr.points]="todayPoint.angle" />
      <line *ngIf="todayPoint" [attr.x1]="todayPoint.x" [attr.x2]="todayPoint.x" [attr.y1]="0" [attr.y2]="'100%'" class="today-line"></line>
    </g>
  </g>
</svg>
